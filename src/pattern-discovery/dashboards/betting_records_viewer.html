<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Betting Records Viewer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Consolas', 'Monaco', monospace;
            background: #1a1a1a;
            color: #ffffff;
            font-size: 13px;
            line-height: 1.4;
            padding: 20px;
        }

        .header {
            background: #2d2d2d;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            text-align: center;
        }

        .header h1 {
            color: #4caf50;
            margin-bottom: 10px;
        }

        .strategy-selector {
            background: #2a2a2a;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            border: 1px solid #555;
        }

        .strategy-selector label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #ccc;
        }

        .strategy-select {
            width: 100%;
            background: #1a1a1a;
            color: #fff;
            border: 1px solid #555;
            padding: 8px;
            border-radius: 5px;
            font-size: 13px;
            font-family: inherit;
        }

        .load-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin-top: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 13px;
        }

        .records-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            background: #2d2d2d;
            border-radius: 8px;
            overflow: hidden;
        }

        .records-table th {
            background: #333;
            padding: 10px 8px;
            border-bottom: 1px solid #555;
            text-align: left;
            font-weight: bold;
            color: #ccc;
        }

        .records-table td {
            padding: 8px;
            border-bottom: 1px solid #333;
            vertical-align: top;
        }

        .records-table tr:hover {
            background: #252525;
        }

        .bet-result {
            padding: 3px 8px;
            border-radius: 3px;
            font-weight: bold;
            text-align: center;
            min-width: 40px;
        }

        .result-win {
            background: #4caf50;
            color: white;
        }

        .result-loss {
            background: #f44336;
            color: white;
        }

        .profit-positive { color: #4caf50; }
        .profit-negative { color: #f44336; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ðŸŽ¯ Individual Betting Records Viewer</h1>
        <p>View detailed match-by-match betting records for any strategy pattern</p>
    </div>

    <div class="strategy-selector">
        <label for="strategySelect">Select Strategy to View Betting Records:</label>
        <select id="strategySelect" class="strategy-select">
            <option value="">Choose a strategy...</option>
        </select>
        <button id="loadRecords" class="load-btn">Load Betting Records</button>
    </div>

    <div id="recordsContainer" style="display: none;">
        <table class="records-table">
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Match</th>
                    <th>Week</th>
                    <th>Bet Side</th>
                    <th>Handicap</th>
                    <th>Odds</th>
                    <th>Stake</th>
                    <th>Score</th>
                    <th>Result</th>
                    <th>Payout</th>
                    <th>Profit</th>
                </tr>
            </thead>
            <tbody id="recordsTableBody">
                <!-- Records will be populated here -->
            </tbody>
        </table>
    </div>

    <script>
        // This is a placeholder for now - we'll generate sample data
        // In the real implementation, this would fetch actual betting records
        
        document.addEventListener('DOMContentLoaded', async () => {
            await loadStrategies();
        });

        document.getElementById('loadRecords').addEventListener('click', async () => {
            const selectedStrategy = document.getElementById('strategySelect').value;
            if (selectedStrategy) {
                await loadBettingRecords(selectedStrategy);
            }
        });

        async function loadStrategies() {
            try {
                const response = await fetch('/api/discovery');
                const data = await response.json();
                
                const selector = document.getElementById('strategySelect');
                selector.innerHTML = '<option value="">Choose a strategy...</option>';
                
                // Get strategies from discovery data
                const strategies = data.topPatterns || [];
                
                strategies.forEach(strategy => {
                    const option = document.createElement('option');
                    option.value = strategy.name;
                    option.textContent = `${strategy.name} (${strategy.bets} bets, ${strategy.roi?.toFixed(1)}% ROI)`;
                    option.dataset.strategy = JSON.stringify(strategy);
                    selector.appendChild(option);
                });
                
            } catch (error) {
                console.error('Failed to load strategies:', error);
            }
        }

        async function loadBettingRecords(strategyName) {
            const selector = document.getElementById('strategySelect');
            const selectedOption = Array.from(selector.options).find(opt => opt.value === strategyName);
            
            if (!selectedOption) return;
            
            const strategy = JSON.parse(selectedOption.dataset.strategy);
            
            // Generate sample betting records based on strategy summary
            const records = generateSampleRecords(strategy);
            
            displayBettingRecords(records);
        }

        function generateSampleRecords(strategy) {
            const records = [];
            const teams = ['Arsenal', 'Chelsea', 'Man City', 'Liverpool', 'Man United', 'Tottenham'];
            const winRate = strategy.winRate / 100;
            
            for (let i = 0; i < strategy.bets; i++) {
                const homeTeam = teams[Math.floor(Math.random() * teams.length)];
                let awayTeam = teams[Math.floor(Math.random() * teams.length)];
                while (awayTeam === homeTeam) {
                    awayTeam = teams[Math.floor(Math.random() * teams.length)];
                }
                
                const date = new Date('2023-08-12');
                date.setDate(date.getDate() + i * 7);
                
                const isWin = Math.random() < winRate;
                const odds = (strategy.averageOdds || 1.9) + (Math.random() - 0.5) * 0.3;
                const stake = 200;
                const payout = isWin ? stake * odds : 0;
                const profit = payout - stake;
                
                records.push({
                    date: date.toISOString().split('T')[0],
                    homeTeam,
                    awayTeam,
                    week: Math.floor(i / 10) + 1,
                    betSide: strategy.betSide,
                    handicap: 'AH 0/-0.5',
                    odds: odds.toFixed(2),
                    stake: stake.toFixed(0),
                    homeScore: Math.floor(Math.random() * 4),
                    awayScore: Math.floor(Math.random() * 4),
                    result: isWin ? 'WIN' : 'LOSS',
                    payout: payout.toFixed(2),
                    profit: profit.toFixed(2)
                });
            }
            
            return records;
        }

        function displayBettingRecords(records) {
            const tbody = document.getElementById('recordsTableBody');
            tbody.innerHTML = '';
            
            records.forEach(record => {
                const row = document.createElement('tr');
                const profitClass = parseFloat(record.profit) >= 0 ? 'profit-positive' : 'profit-negative';
                const resultClass = record.result === 'WIN' ? 'result-win' : 'result-loss';
                
                row.innerHTML = `
                    <td>${record.date}</td>
                    <td>${record.homeTeam} vs ${record.awayTeam}</td>
                    <td>${record.week}</td>
                    <td style="font-weight: bold; color: #ffd700;">${record.betSide.toUpperCase()}</td>
                    <td>${record.handicap}</td>
                    <td style="font-weight: bold; color: #ffd700;">${record.odds}</td>
                    <td>$${record.stake}</td>
                    <td>${record.homeScore}-${record.awayScore}</td>
                    <td><span class="bet-result ${resultClass}">${record.result}</span></td>
                    <td>$${record.payout}</td>
                    <td class="${profitClass}">$${record.profit}</td>
                `;
                
                tbody.appendChild(row);
            });
            
            document.getElementById('recordsContainer').style.display = 'block';
        }
    </script>
</body>
</html> 